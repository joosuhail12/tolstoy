---
title: "Create Flow" 
openapi: "POST /flows"
---

# Create Flow

Create a new workflow with steps, inputs, and configuration. Flows are created in `draft` status and must be activated before they can be executed.

<RequestExample>

```bash cURL
curl -X POST "https://tolstoy.getpullse.com/flows" \
  -H "x-org-id: org_1234567890abcdef" \
  -H "x-user-id: user_abcdef1234567890" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Customer Onboarding Flow",
    "description": "Automates new customer onboarding process",
    "tags": ["onboarding", "automation"],
    "inputs": [
      {
        "name": "customer_email",
        "type": "string",
        "required": true,
        "description": "Customer email address"
      },
      {
        "name": "plan_type", 
        "type": "string",
        "required": true,
        "description": "Selected subscription plan"
      }
    ],
    "steps": [
      {
        "key": "send_welcome_email",
        "name": "Send Welcome Email",
        "action": "email-send",
        "inputs": {
          "to": "{{customer_email}}",
          "subject": "Welcome to our platform!",
          "template": "welcome-template"
        }
      },
      {
        "key": "create_account",
        "name": "Create Account",
        "action": "http-request",
        "inputs": {
          "method": "POST",
          "url": "https://api.company.com/accounts",
          "body": {
            "email": "{{customer_email}}",
            "plan": "{{plan_type}}"
          }
        }
      }
    ]
  }'
```

```typescript TypeScript
interface CreateFlowRequest {
  name: string;
  description?: string;
  tags?: string[];
  inputs: FlowInput[];
  steps: FlowStep[];
}

const flowData: CreateFlowRequest = {
  name: "Customer Onboarding Flow",
  description: "Automates new customer onboarding process",
  tags: ["onboarding", "automation"],
  inputs: [
    {
      name: "customer_email",
      type: "string", 
      required: true,
      description: "Customer email address"
    },
    {
      name: "plan_type",
      type: "string",
      required: true,
      description: "Selected subscription plan"
    }
  ],
  steps: [
    {
      key: "send_welcome_email",
      name: "Send Welcome Email",
      action: "email-send",
      inputs: {
        to: "{{customer_email}}",
        subject: "Welcome to our platform!",
        template: "welcome-template"
      }
    },
    {
      key: "create_account", 
      name: "Create Account",
      action: "http-request",
      inputs: {
        method: "POST",
        url: "https://api.company.com/accounts",
        body: {
          email: "{{customer_email}}",
          plan: "{{plan_type}}"
        }
      }
    }
  ]
};

const response = await fetch('https://tolstoy.getpullse.com/flows', {
  method: 'POST',
  headers: {
    'x-org-id': 'org_1234567890abcdef',
    'x-user-id': 'user_abcdef1234567890',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(flowData)
});

const flow = await response.json();
console.log('Created flow:', flow.data.id);
```

```python Python
import requests
import json

flow_data = {
    "name": "Customer Onboarding Flow",
    "description": "Automates new customer onboarding process", 
    "tags": ["onboarding", "automation"],
    "inputs": [
        {
            "name": "customer_email",
            "type": "string",
            "required": True,
            "description": "Customer email address"
        },
        {
            "name": "plan_type",
            "type": "string", 
            "required": True,
            "description": "Selected subscription plan"
        }
    ],
    "steps": [
        {
            "key": "send_welcome_email",
            "name": "Send Welcome Email",
            "action": "email-send",
            "inputs": {
                "to": "{{customer_email}}",
                "subject": "Welcome to our platform!",
                "template": "welcome-template"
            }
        },
        {
            "key": "create_account",
            "name": "Create Account", 
            "action": "http-request",
            "inputs": {
                "method": "POST",
                "url": "https://api.company.com/accounts",
                "body": {
                    "email": "{{customer_email}}",
                    "plan": "{{plan_type}}"
                }
            }
        }
    ]
}

headers = {
    'x-org-id': 'org_1234567890abcdef',
    'x-user-id': 'user_abcdef1234567890',
    'Content-Type': 'application/json'
}

response = requests.post(
    'https://tolstoy.getpullse.com/flows',
    headers=headers,
    json=flow_data
)

if response.status_code == 201:
    flow = response.json()
    print(f"Created flow: {flow['data']['id']}")
else:
    print(f"Error: {response.json()}")
```

</RequestExample>

## Request Body

### Flow Object

<ParamField body="name" type="string" required>
Human-readable name for the flow. Must be unique within your organization.

**Constraints:**
- Length: 1-255 characters
- Cannot be only whitespace
</ParamField>

<ParamField body="description" type="string">
Optional description explaining the flow's purpose and functionality.

**Constraints:**
- Maximum length: 1000 characters
</ParamField>

<ParamField body="tags" type="string[]">
Array of tags for categorizing and filtering flows.

**Constraints:**
- Maximum 20 tags per flow
- Each tag: 1-50 characters
- Tags are case-insensitive and stored in lowercase
</ParamField>

<ParamField body="inputs" type="FlowInput[]" required>
Array of input parameters required for flow execution.

**Constraints:**
- Minimum 0 inputs, maximum 20 inputs per flow
- Input names must be unique within the flow
</ParamField>

<ParamField body="steps" type="FlowStep[]" required>
Array of workflow steps that define the flow's logic.

**Constraints:**
- Minimum 1 step, maximum 50 steps per flow
- Step keys must be unique within the flow
</ParamField>

### FlowInput Object

<ParamField body="name" type="string" required>
Unique input parameter name used for variable substitution.

**Format:** lowercase letters, numbers, underscores only (e.g., `customer_email`, `order_id`)
</ParamField>

<ParamField body="type" type="string" required>
Data type for validation and documentation.

**Available types:**
- `string` - Text values
- `number` - Numeric values (integer or decimal)
- `boolean` - True/false values  
- `object` - JSON objects
- `array` - JSON arrays
</ParamField>

<ParamField body="required" type="boolean" default="false">
Whether this input is required for flow execution.
</ParamField>

<ParamField body="description" type="string">
Human-readable description of the input parameter.

**Constraints:**
- Maximum length: 500 characters
</ParamField>

<ParamField body="default_value" type="any">
Default value used when input is not provided during execution.

**Note:** Must match the specified `type`
</ParamField>

### FlowStep Object

<ParamField body="key" type="string" required>
Unique identifier for the step within the flow.

**Format:** lowercase letters, numbers, underscores only (e.g., `send_email`, `update_crm`)
</ParamField>

<ParamField body="name" type="string" required>
Human-readable step name for display purposes.

**Constraints:**
- Length: 1-255 characters
</ParamField>

<ParamField body="action" type="string" required>
The action to execute for this step.

**Examples:**
- `email-send` - Send email
- `http-request` - Make HTTP request
- `slack-message` - Send Slack message
- `delay` - Wait/pause execution
- `condition` - Conditional logic
</ParamField>

<ParamField body="inputs" type="object">
Configuration and parameters for the action.

**Variable Substitution:**
Use `{{variable_name}}` syntax to reference flow inputs and previous step outputs.

**Examples:**
- `{{customer_email}}` - Flow input
- `{{send_email.message_id}}` - Output from 'send_email' step
</ParamField>

<ParamField body="execute_if" type="string">
Conditional expression that determines if the step should execute.

**Examples:**
- `"{{plan_type}} == 'premium'"` - Execute only for premium plans
- `"{{user.age}} >= 18"` - Execute for adults only
- `"{{previous_step.success}} == true"` - Execute only if previous step succeeded
</ParamField>

<ParamField body="retry_config" type="object">
Retry configuration for failed step execution.

<Expandable title="Retry Config Fields">
  <ParamField body="max_attempts" type="integer" default="1">
    Maximum number of retry attempts (1-5)
  </ParamField>
  <ParamField body="delay_ms" type="integer" default="1000">
    Initial delay between retries in milliseconds
  </ParamField>
  <ParamField body="backoff_multiplier" type="number" default="2.0">
    Multiplier for exponential backoff (1.0-5.0)
  </ParamField>
  <ParamField body="retry_on_errors" type="string[]">
    Array of error codes that trigger retries (e.g., `["TIMEOUT", "RATE_LIMITED"]`)
  </ParamField>
</Expandable>
</ParamField>

## Response

<ResponseExample>

```json Success Response
{
  "success": true,
  "data": {
    "id": "flow_abc123def456",
    "name": "Customer Onboarding Flow",
    "description": "Automates new customer onboarding process",
    "status": "draft",
    "version": 1,
    "tags": ["onboarding", "automation"],
    "inputs": [
      {
        "name": "customer_email",
        "type": "string",
        "required": true,
        "description": "Customer email address"
      },
      {
        "name": "plan_type",
        "type": "string",
        "required": true,
        "description": "Selected subscription plan"
      }
    ],
    "steps": [
      {
        "key": "send_welcome_email",
        "name": "Send Welcome Email",
        "action": "email-send",
        "inputs": {
          "to": "{{customer_email}}",
          "subject": "Welcome to our platform!",
          "template": "welcome-template"
        }
      },
      {
        "key": "create_account",
        "name": "Create Account",
        "action": "http-request",
        "inputs": {
          "method": "POST",
          "url": "https://api.company.com/accounts",
          "body": {
            "email": "{{customer_email}}",
            "plan": "{{plan_type}}"
          }
        }
      }
    ],
    "created_by": {
      "id": "user_abcdef1234567890",
      "name": "John Smith",
      "email": "john@company.com"
    },
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  },
  "metadata": {
    "request_id": "req_abc123def456",
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

```json Validation Error Response
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Flow validation failed",
    "details": {
      "field": "steps[0].inputs.to",
      "value": "{{invalid_variable}}",
      "reason": "Referenced variable 'invalid_variable' is not defined in flow inputs"
    }
  },
  "metadata": {
    "request_id": "req_error123",
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

```json Duplicate Name Error
{
  "success": false,
  "error": {
    "code": "DUPLICATE_RESOURCE",
    "message": "Flow with this name already exists",
    "details": {
      "field": "name",
      "value": "Customer Onboarding Flow",
      "existing_flow_id": "flow_existing123"
    }
  },
  "metadata": {
    "request_id": "req_error456",
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

</ResponseExample>

## Response Fields

The response contains the complete flow object with additional computed fields:

<ResponseField name="id" type="string">
Unique flow identifier assigned by the system
</ResponseField>

<ResponseField name="status" type="string">
Flow status - newly created flows are always set to `draft`
</ResponseField>

<ResponseField name="version" type="integer">
Flow version number - starts at 1 for new flows
</ResponseField>

<ResponseField name="created_by" type="object">
Information about the user who created the flow
</ResponseField>

<ResponseField name="created_at" type="string">
ISO 8601 timestamp when the flow was created
</ResponseField>

<ResponseField name="updated_at" type="string">  
ISO 8601 timestamp when the flow was last modified
</ResponseField>

## Status Codes

<ResponseField name="201" type="Created">
Flow created successfully
</ResponseField>

<ResponseField name="400" type="Bad Request">
Invalid request format or missing required fields
</ResponseField>

<ResponseField name="401" type="Unauthorized">
Missing or invalid authentication headers
</ResponseField>

<ResponseField name="403" type="Forbidden">
Insufficient permissions to create flows
</ResponseField>

<ResponseField name="409" type="Conflict">
Flow with the same name already exists
</ResponseField>

<ResponseField name="422" type="Unprocessable Entity">
Validation errors in flow definition
</ResponseField>

<ResponseField name="429" type="Too Many Requests">
Rate limit exceeded
</ResponseField>

<ResponseField name="500" type="Internal Server Error">
Server error - contact support if this persists
</ResponseField>

## Validation Rules

### Flow-Level Validation

<Accordion title="Name Validation">
- Must be 1-255 characters long
- Cannot be only whitespace
- Must be unique within your organization
- Special characters are allowed but may be sanitized for display
</Accordion>

<Accordion title="Step Validation">
- Minimum 1 step, maximum 50 steps per flow
- Step keys must be unique within the flow
- Step keys can only contain lowercase letters, numbers, and underscores
- Step names must be 1-255 characters long
- Referenced actions must be valid and available
</Accordion>

<Accordion title="Input Validation">
- Maximum 20 inputs per flow
- Input names must be unique within the flow
- Input names can only contain lowercase letters, numbers, and underscores
- Input types must be one of: `string`, `number`, `boolean`, `object`, `array`
- Default values must match the specified input type
</Accordion>

<Accordion title="Variable Reference Validation">
- All variable references in step inputs must be valid
- Variables can reference flow inputs or outputs from previous steps
- Syntax: `{{variable_name}}` or `{{step_key.output_field}}`
- Circular dependencies between steps are not allowed
</Accordion>

## Examples

### Simple Linear Flow

<CodeGroup>

```json Simple Email Notification
{
  "name": "Simple Email Notification",
  "description": "Send a notification email",
  "inputs": [
    {
      "name": "recipient_email",
      "type": "string",
      "required": true,
      "description": "Email address to send notification to"
    },
    {
      "name": "message",
      "type": "string", 
      "required": true,
      "description": "Message content"
    }
  ],
  "steps": [
    {
      "key": "send_notification",
      "name": "Send Email Notification", 
      "action": "email-send",
      "inputs": {
        "to": "{{recipient_email}}",
        "subject": "Notification",
        "body": "{{message}}"
      }
    }
  ]
}
```

```json Multi-Step Process
{
  "name": "Order Processing Flow",
  "description": "Process new orders with validation and fulfillment",
  "tags": ["orders", "fulfillment", "automation"],
  "inputs": [
    {
      "name": "order_id",
      "type": "string",
      "required": true,
      "description": "Unique order identifier"
    },
    {
      "name": "customer_tier",
      "type": "string",
      "required": false,
      "default_value": "standard",
      "description": "Customer tier for processing priority"
    }
  ],
  "steps": [
    {
      "key": "validate_order",
      "name": "Validate Order",
      "action": "http-request",
      "inputs": {
        "method": "GET", 
        "url": "https://api.orders.com/orders/{{order_id}}/validate"
      }
    },
    {
      "key": "process_payment",
      "name": "Process Payment",
      "action": "http-request",
      "execute_if": "{{validate_order.valid}} == true",
      "inputs": {
        "method": "POST",
        "url": "https://api.payments.com/charge",
        "body": {
          "order_id": "{{order_id}}",
          "amount": "{{validate_order.total_amount}}"
        }
      },
      "retry_config": {
        "max_attempts": 3,
        "delay_ms": 2000,
        "backoff_multiplier": 2.0,
        "retry_on_errors": ["TIMEOUT", "RATE_LIMITED"]
      }
    },
    {
      "key": "fulfill_order",
      "name": "Fulfill Order",
      "action": "http-request",
      "execute_if": "{{process_payment.success}} == true",
      "inputs": {
        "method": "POST",
        "url": "https://api.fulfillment.com/fulfill",
        "body": {
          "order_id": "{{order_id}}",
          "priority": "{{customer_tier}}"
        }
      }
    },
    {
      "key": "send_confirmation",
      "name": "Send Order Confirmation",
      "action": "email-send", 
      "execute_if": "{{fulfill_order.shipped}} == true",
      "inputs": {
        "to": "{{validate_order.customer_email}}",
        "subject": "Order Confirmation - {{order_id}}",
        "template": "order-confirmation",
        "variables": {
          "order_id": "{{order_id}}",
          "tracking_number": "{{fulfill_order.tracking_number}}"
        }
      }
    }
  ]
}
```

</CodeGroup>

### Conditional Flow with Branching

<CodeGroup>

```json Customer Support Routing
{
  "name": "Customer Support Routing",
  "description": "Route support tickets based on priority and type",
  "tags": ["support", "routing", "automation"],
  "inputs": [
    {
      "name": "ticket_id",
      "type": "string",
      "required": true
    },
    {
      "name": "priority",
      "type": "string",
      "required": true,
      "description": "Priority: low, medium, high, critical"
    },
    {
      "name": "category",
      "type": "string", 
      "required": true,
      "description": "Ticket category"
    },
    {
      "name": "customer_tier",
      "type": "string",
      "required": false,
      "default_value": "standard"
    }
  ],
  "steps": [
    {
      "key": "classify_ticket",
      "name": "Classify Ticket Urgency",
      "action": "condition",
      "inputs": {
        "conditions": [
          {
            "if": "{{priority}} == 'critical' || {{customer_tier}} == 'enterprise'",
            "then": "urgent"
          },
          {
            "if": "{{priority}} == 'high'",
            "then": "high_priority"
          }
        ],
        "else": "normal"
      }
    },
    {
      "key": "notify_urgent_team",
      "name": "Notify Urgent Response Team",
      "action": "slack-message",
      "execute_if": "{{classify_ticket.result}} == 'urgent'",
      "inputs": {
        "channel": "#urgent-support",
        "message": "ðŸš¨ URGENT: Ticket {{ticket_id}} requires immediate attention",
        "attachments": [
          {
            "color": "danger",
            "fields": [
              {
                "title": "Ticket ID",
                "value": "{{ticket_id}}",
                "short": true
              },
              {
                "title": "Priority",
                "value": "{{priority}}",
                "short": true
              },
              {
                "title": "Customer Tier", 
                "value": "{{customer_tier}}",
                "short": true
              }
            ]
          }
        ]
      }
    },
    {
      "key": "assign_to_specialist",
      "name": "Assign to Category Specialist",
      "action": "http-request",
      "execute_if": "{{classify_ticket.result}} != 'urgent'",
      "inputs": {
        "method": "POST",
        "url": "https://api.support.com/tickets/{{ticket_id}}/assign",
        "body": {
          "category": "{{category}}",
          "priority": "{{priority}}",
          "auto_assign": true
        }
      }
    },
    {
      "key": "set_sla_reminder",
      "name": "Set SLA Reminder",
      "action": "delay",
      "inputs": {
        "duration_hours": "{{classify_ticket.result == 'urgent' ? 1 : (classify_ticket.result == 'high_priority' ? 4 : 24)}}",
        "callback_webhook": "https://api.company.com/sla-reminder",
        "callback_data": {
          "ticket_id": "{{ticket_id}}",
          "priority": "{{priority}}"
        }
      }
    }
  ]
}
```

</CodeGroup>

## Common Patterns

### Error Handling Flow

```json
{
  "key": "api_call_with_fallback",
  "name": "API Call with Fallback",
  "action": "http-request",
  "inputs": {
    "method": "POST",
    "url": "https://primary-api.com/endpoint"
  },
  "retry_config": {
    "max_attempts": 2,
    "delay_ms": 1000,
    "retry_on_errors": ["TIMEOUT", "SERVER_ERROR"]
  }
}
```

### Variable Transformation

```json
{
  "key": "transform_data",
  "name": "Transform Customer Data", 
  "action": "javascript",
  "inputs": {
    "code": `
      const customer = input.customer;
      return {
        full_name: customer.first_name + ' ' + customer.last_name,
        email_domain: customer.email.split('@')[1],
        age_group: customer.age < 25 ? 'young' : customer.age < 55 ? 'middle' : 'senior'
      };
    `,
    "variables": {
      "customer": "{{customer_data}}"
    }
  }
}
```

### Parallel Execution

```json
{
  "key": "notify_multiple_channels",
  "name": "Notify All Channels",
  "action": "parallel",
  "inputs": {
    "steps": [
      {
        "action": "email-send",
        "inputs": {
          "to": "{{customer_email}}",
          "subject": "Welcome!"
        }
      },
      {
        "action": "slack-message", 
        "inputs": {
          "channel": "#new-customers",
          "message": "New customer: {{customer_name}}"
        }
      },
      {
        "action": "http-request",
        "inputs": {
          "method": "POST",
          "url": "https://crm.com/customers",
          "body": "{{customer_data}}"
        }
      }
    ]
  }
}
```

## Next Steps

After creating a flow, you'll typically want to:

1. **[Activate the Flow](/api/flows/put-flows)** - Change status from `draft` to `active`
2. **[Test the Flow](/api/flows/post-flows-execute)** - Execute with sample data
3. **[Monitor Executions](/api/flows/get-flows-executions)** - Track performance and results

<CardGroup cols={2}>
  <Card title="Update Flow" icon="edit" href="/api/flows/put-flows">
    Modify existing flows and manage versions
  </Card>
  <Card title="Execute Flow" icon="play" href="/api/flows/post-flows-execute">
    Start flow executions with input data
  </Card>
</CardGroup>

---

<Warning>
**Important**: Flows created via API start in `draft` status. Remember to activate them before attempting execution.
</Warning>