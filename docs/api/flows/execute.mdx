---
title: "Execute Flow"
description: "Manually trigger a flow execution"
---

# Execute Flow

<Badge variant="warning">POST</Badge> `/flows/{flow_id}/execute`

Manually trigger the execution of a flow with provided input variables. Returns execution details and tracks progress.

## Request

### **HTTP Request**

```http
POST https://api.tolstoy.dev/flows/{flow_id}/execute
```

### **Path Parameters**

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `flow_id` | string | Yes | The unique identifier of the flow to execute |

### **Request Body**

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `inputs` | object | No | Input variables for the flow |
| `async` | boolean | No | Execute asynchronously (default: false) |
| `timeout_override` | integer | No | Override default timeout (milliseconds) |
| `trace_id` | string | No | Custom trace ID for debugging |
| `context` | object | No | Additional execution context |
| `dry_run` | boolean | No | Simulate execution without running actions |

## Response

### **Synchronous Execution Response**

<CodeGroup>

```json 200 OK
{
  "execution": {
    "id": "exec_flow_789xyz123",
    "flow_id": "flow_xyz789abc123",
    "flow_name": "customer_onboarding",
    "status": "success",
    "started_at": "2024-01-15T20:00:00.000Z",
    "completed_at": "2024-01-15T20:00:04.500Z",
    "duration_ms": 4500,
    "trigger": {
      "type": "manual",
      "triggered_by": "user_current123",
      "trace_id": "trace_custom_456"
    },
    "inputs": {
      "customer_email": "john.doe@example.com",
      "customer_name": "John Doe",
      "plan_type": "professional"
    },
    "steps": [
      {
        "step_id": "step_1",
        "step_name": "validate_customer",
        "action_id": "act_validate_email",
        "status": "success",
        "started_at": "2024-01-15T20:00:00.100Z",
        "completed_at": "2024-01-15T20:00:00.800Z",
        "duration_ms": 700,
        "inputs": {
          "email": "john.doe@example.com",
          "domain_check": true
        },
        "outputs": {
          "valid": true,
          "domain": "example.com",
          "mx_records": true
        }
      },
      {
        "step_id": "step_2",
        "step_name": "create_crm_record",
        "action_id": "act_create_salesforce_lead",
        "status": "success",
        "started_at": "2024-01-15T20:00:00.900Z",
        "completed_at": "2024-01-15T20:00:02.400Z",
        "duration_ms": 1500,
        "inputs": {
          "email": "john.doe@example.com",
          "name": "John Doe",
          "company": "Example Corp",
          "source": "Website Signup"
        },
        "outputs": {
          "lead_id": "00Q1234567890ABC",
          "created": true,
          "url": "https://salesforce.com/leads/00Q1234567890ABC"
        }
      },
      {
        "step_id": "step_3",
        "step_name": "send_welcome_email",
        "action_id": "act_send_email",
        "status": "success",
        "started_at": "2024-01-15T20:00:00.900Z",
        "completed_at": "2024-01-15T20:00:02.100Z",
        "duration_ms": 1200,
        "parallel": true,
        "inputs": {
          "to": ["john.doe@example.com"],
          "subject": "Welcome to Tolstoy!",
          "template": "welcome_email"
        },
        "outputs": {
          "message_id": "msg_987654321",
          "sent": true,
          "provider": "sendgrid"
        }
      }
    ],
    "outputs": {
      "validation_result": true,
      "crm_lead_id": "00Q1234567890ABC",
      "email_sent": true
    },
    "metadata": {
      "total_steps": 3,
      "successful_steps": 3,
      "failed_steps": 0,
      "skipped_steps": 0,
      "parallel_executions": 2
    }
  }
}
```

</CodeGroup>

### **Asynchronous Execution Response**

<CodeGroup>

```json 202 Accepted
{
  "execution": {
    "id": "exec_flow_async_456",
    "flow_id": "flow_xyz789abc123",
    "status": "running",
    "created_at": "2024-01-15T20:00:00.000Z",
    "estimated_duration_ms": 5000,
    "polling_url": "https://api.tolstoy.dev/executions/exec_flow_async_456",
    "webhook_url": "https://api.tolstoy.dev/webhooks/exec_flow_async_456",
    "cancel_url": "https://api.tolstoy.dev/executions/exec_flow_async_456/cancel"
  }
}
```

</CodeGroup>

## Examples

### **Basic Execution**

<CodeGroup>

```bash cURL
curl -X POST 'https://api.tolstoy.dev/flows/flow_xyz789abc123/execute' \
  -H 'Authorization: Bearer YOUR_API_KEY' \
  -H 'Content-Type: application/json' \
  -d '{
    "inputs": {
      "customer_email": "jane.smith@example.com",
      "customer_name": "Jane Smith",
      "plan_type": "enterprise"
    }
  }'
```

```javascript JavaScript
const flowId = 'flow_xyz789abc123';

const executionRequest = {
  inputs: {
    customer_email: "jane.smith@example.com",
    customer_name: "Jane Smith",
    plan_type: "enterprise",
    company: "Smith Corp"
  },
  context: {
    source: "api",
    user_id: "user_123",
    request_id: "req_custom_789"
  },
  trace_id: "trace_api_execution_001"
};

const response = await fetch(
  `https://api.tolstoy.dev/flows/${flowId}/execute`,
  {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${apiKey}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(executionRequest)
  }
);

const result = await response.json();
console.log('Execution ID:', result.execution.id);
console.log('Status:', result.execution.status);
console.log('Duration:', `${result.execution.duration_ms}ms`);

// Display step results
result.execution.steps.forEach(step => {
  console.log(`${step.step_name}: ${step.status} (${step.duration_ms}ms)`);
});
```

```python Python
import requests
import json

flow_id = 'flow_xyz789abc123'

execution_request = {
    "inputs": {
        "order_id": "ORD-2024-001",
        "customer_id": "CUST-456",
        "items": [
            {"sku": "PROD-001", "quantity": 2, "price": 29.99},
            {"sku": "PROD-002", "quantity": 1, "price": 49.99}
        ],
        "total_amount": 109.97
    },
    "async": False,
    "timeout_override": 30000
}

response = requests.post(
    f'https://api.tolstoy.dev/flows/{flow_id}/execute',
    headers={
        'Authorization': f'Bearer {api_key}',
        'Content-Type': 'application/json'
    },
    json=execution_request
)

if response.status_code == 200:
    result = response.json()
    execution = result['execution']
    print(f"Execution completed: {execution['id']}")
    print(f"Status: {execution['status']}")
    print(f"Duration: {execution['duration_ms']}ms")
    
    # Show outputs
    print("\nOutputs:")
    for key, value in execution['outputs'].items():
        print(f"  {key}: {value}")
```

</CodeGroup>

### **Asynchronous Execution with Polling**

<CodeGroup>

```javascript Async with Polling
async function executeFlowAsync(flowId, inputs, apiKey) {
  // Start async execution
  const startResponse = await fetch(
    `https://api.tolstoy.dev/flows/${flowId}/execute`,
    {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${apiKey}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        inputs,
        async: true
      })
    }
  );
  
  const { execution } = await startResponse.json();
  console.log(`Started execution: ${execution.id}`);
  console.log(`Polling URL: ${execution.polling_url}`);
  
  // Poll for completion
  let result;
  let attempts = 0;
  const maxAttempts = 60; // 5 minutes with 5-second intervals
  
  while (attempts < maxAttempts) {
    await new Promise(resolve => setTimeout(resolve, 5000));
    
    const statusResponse = await fetch(
      execution.polling_url,
      {
        headers: {
          'Authorization': `Bearer ${apiKey}`,
          'Content-Type': 'application/json'
        }
      }
    );
    
    result = await statusResponse.json();
    
    console.log(`Status: ${result.execution.status} (attempt ${attempts + 1})`);
    
    // Show step progress
    if (result.execution.steps) {
      const completed = result.execution.steps.filter(s => s.status === 'success').length;
      const total = result.execution.steps.length;
      console.log(`Progress: ${completed}/${total} steps completed`);
    }
    
    if (!['pending', 'running'].includes(result.execution.status)) {
      break;
    }
    
    attempts++;
  }
  
  return result;
}

// Usage
const result = await executeFlowAsync(
  'flow_long_running',
  { 
    dataset: 'large',
    process_type: 'full'
  },
  apiKey
);

console.log('Final status:', result.execution.status);
console.log('Total duration:', `${result.execution.duration_ms}ms`);
```

</CodeGroup>

### **Dry Run Execution**

<CodeGroup>

```javascript Test Flow with Dry Run
const flowId = 'flow_xyz789abc123';

// Test flow without actually executing actions
const dryRunRequest = {
  inputs: {
    customer_email: "test@example.com",
    customer_name: "Test User",
    plan_type: "trial"
  },
  dry_run: true
};

const response = await fetch(
  `https://api.tolstoy.dev/flows/${flowId}/execute`,
  {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${apiKey}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(dryRunRequest)
  }
);

const result = await response.json();

console.log('Dry Run Results:');
console.log('Would execute steps:');
result.execution.steps.forEach((step, index) => {
  console.log(`${index + 1}. ${step.step_name} (${step.action_id})`);
  console.log(`   Inputs: ${JSON.stringify(step.planned_inputs)}`);
  if (step.depends_on) {
    console.log(`   Depends on: ${step.depends_on.join(', ')}`);
  }
});

if (result.execution.validation_errors) {
  console.log('\nValidation Errors:');
  result.execution.validation_errors.forEach(error => {
    console.log(`- ${error.field}: ${error.message}`);
  });
}
```

</CodeGroup>

### **Batch Flow Execution**

<CodeGroup>

```javascript Execute Multiple Flows
async function batchExecuteFlows(executions, apiKey) {
  const promises = executions.map(async ({ flowId, inputs }) => {
    try {
      const response = await fetch(
        `https://api.tolstoy.dev/flows/${flowId}/execute`,
        {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${apiKey}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ 
            inputs,
            async: true // Use async for parallel execution
          })
        }
      );
      
      const result = await response.json();
      return {
        flowId,
        success: true,
        execution: result.execution
      };
    } catch (error) {
      return {
        flowId,
        success: false,
        error: error.message
      };
    }
  });
  
  const results = await Promise.all(promises);
  
  // Monitor all executions
  const monitoring = results
    .filter(r => r.success)
    .map(r => ({
      flowId: r.flowId,
      executionId: r.execution.id,
      pollingUrl: r.execution.polling_url
    }));
  
  console.log(`Started ${monitoring.length} flow executions`);
  return { results, monitoring };
}

// Usage
const executions = [
  {
    flowId: 'flow_customer_onboard',
    inputs: { email: 'user1@example.com', name: 'User One' }
  },
  {
    flowId: 'flow_order_process',
    inputs: { order_id: 'ORD-001', amount: 99.99 }
  },
  {
    flowId: 'flow_data_sync',
    inputs: { source: 'crm', target: 'warehouse' }
  }
];

const { results, monitoring } = await batchExecuteFlows(executions, apiKey);
```

</CodeGroup>

## Error Responses

<CodeGroup>

```json 400 Bad Request
{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid input parameters",
    "type": "validation",
    "details": [
      {
        "field": "inputs.customer_email",
        "issue": "Required field missing"
      },
      {
        "field": "inputs.plan_type",
        "issue": "Invalid value 'invalid' - must be one of: starter, professional, enterprise"
      }
    ],
    "timestamp": "2024-01-15T10:30:00Z",
    "request_id": "req_123456789"
  }
}
```

```json 422 Execution Failed
{
  "execution": {
    "id": "exec_flow_failed_789",
    "flow_id": "flow_xyz789abc123",
    "status": "failed",
    "started_at": "2024-01-15T20:00:00.000Z",
    "failed_at": "2024-01-15T20:00:02.500Z",
    "duration_ms": 2500,
    "error": {
      "step_id": "step_2",
      "step_name": "create_crm_record",
      "error_code": "ACTION_FAILED",
      "message": "Failed to create Salesforce lead",
      "details": {
        "provider_error": "API rate limit exceeded",
        "retry_possible": true
      }
    },
    "steps_completed": 1,
    "steps_failed": 1
  }
}
```

```json 409 Conflict
{
  "error": {
    "code": "FLOW_ALREADY_RUNNING",
    "message": "Flow execution already in progress",
    "type": "conflict",
    "details": {
      "existing_execution_id": "exec_flow_running_123",
      "started_at": "2024-01-15T19:59:55Z"
    },
    "hint": "Wait for current execution to complete or cancel it",
    "timestamp": "2024-01-15T20:00:00Z",
    "request_id": "req_123456789"
  }
}
```

</CodeGroup>

## Execution States

| Status | Description |
|--------|-------------|
| `pending` | Execution queued but not started |
| `running` | Execution in progress |
| `success` | All steps completed successfully |
| `partial_success` | Some steps succeeded, some failed or skipped |
| `failed` | Execution failed |
| `cancelled` | Execution was cancelled |
| `timeout` | Execution exceeded timeout limit |

## API Playground

Try executing a flow:

<ApiPlayground
  method="POST"
  endpoint="/flows/{flow_id}/execute"
  baseUrl="https://api.tolstoy.dev"
  auth={{
    type: "bearer",
    placeholder: "Your API Key"
  }}
  pathParams={[
    {
      name: "flow_id",
      placeholder: "flow_xyz789abc123",
      description: "The unique identifier of the flow to execute",
      required: true
    }
  ]}
  body={{
    type: "json",
    schema: {
      inputs: {
        type: "object",
        defaultValue: {
          customer_email: "jane.smith@example.com",
          customer_name: "Jane Smith",
          plan_type: "enterprise"
        },
        description: "Input variables for the flow"
      },
      async: {
        type: "boolean",
        defaultValue: false,
        description: "Execute asynchronously"
      },
      timeout_override: {
        type: "integer",
        placeholder: 60000,
        description: "Override default timeout (milliseconds)"
      },
      trace_id: {
        type: "string",
        placeholder: "trace_custom_456",
        description: "Custom trace ID for debugging"
      },
      dry_run: {
        type: "boolean",
        defaultValue: false,
        description: "Simulate execution without running actions"
      }
    }
  }}
  sampleResponse={{
    "execution": {
      "id": "exec_flow_789xyz123",
      "flow_id": "flow_xyz789abc123",
      "status": "success",
      "duration_ms": 4500,
      "steps": [
        {
          "step_id": "step_1",
          "status": "success",
          "duration_ms": 700
        }
      ],
      "outputs": {
        "validation_result": true,
        "crm_lead_id": "00Q1234567890ABC"
      }
    }
  }}
/>

## Related Endpoints

<CardGroup cols={2}>
  <Card title="Get Execution" icon="file" href="/api/executions/get">
    Retrieve execution details
  </Card>
  <Card title="Cancel Execution" icon="stop" href="/api/executions/cancel">
    Cancel a running execution
  </Card>
  <Card title="Execution Logs" icon="scroll" href="/api/execution-logs/get">
    View detailed execution logs
  </Card>
  <Card title="Test Flow" icon="vial" href="/api/flows/test">
    Test flow configuration
  </Card>
</CardGroup>