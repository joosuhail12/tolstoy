---
title: Execute Action
description: "Execute a single action independently of workflows using the execute endpoint"
---

# Execute Single Action

The execute action endpoint allows you to run individual actions outside of workflow contexts. This is perfect for testing actions, building custom integrations, or executing standalone operations.

## Overview

**Endpoint:** `POST /actions/{key}/execute`

Execute any configured action by its unique key with custom inputs. The system will:

1. Validate inputs against the action's input schema
2. Resolve authentication credentials (API keys or OAuth tokens)
3. Make the HTTP request to the target API
4. Return the response with execution metadata

## Authentication

This endpoint requires organization-level authentication and optionally user-scoped authentication for OAuth2 flows.

### Required Headers

| Header | Description | Example |
|--------|-------------|---------|
| `X-Org-ID` | Organization identifier | `org_12345` |
| `Authorization` | API key for organization access | `Bearer sk_test_...` |

### Optional Headers

| Header | Description | Example |
|--------|-------------|---------|
| `X-User-ID` | User identifier for user-scoped OAuth | `user_67890` |

## Request Format

### Path Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `key` | string | Unique action key/identifier |

### Request Body

```json
{
  "inputs": {
    "param1": "value1",
    "param2": "value2"
  }
}
```

The `inputs` object should contain parameters that match the action's `inputSchema`. All required fields must be provided, and values will be validated according to the schema.

## Response Format

### Success Response (200)

```json
{
  "success": true,
  "executionId": "exec_1704123456_abc123def",
  "duration": 1250,
  "data": {
    "id": "msg_789",
    "status": "sent",
    "timestamp": "2024-01-15T10:30:00Z"
  },
  "outputs": {
    "orgId": "org_12345",
    "actionKey": "send-slack-message",
    "toolKey": "Slack",
    "timestamp": "2024-01-15T10:30:00Z",
    "statusCode": 200,
    "url": "https://slack.com/api/chat.postMessage"
  }
}
```

### Response Fields

| Field | Type | Description |
|-------|------|-------------|
| `success` | boolean | Whether the action executed successfully |
| `executionId` | string | Unique identifier for this execution |
| `duration` | number | Execution time in milliseconds |
| `data` | object | Response data from the target API |
| `outputs` | object | Metadata about the execution |

## Error Responses

### 400 Bad Request

Missing required headers or invalid input data:

```json
{
  "statusCode": 400,
  "message": "X-Org-ID header required",
  "error": "Bad Request"
}
```

### 404 Not Found

Action with the specified key doesn't exist:

```json
{
  "statusCode": 404,
  "message": "Action \"invalid-key\" not found",
  "error": "Not Found"
}
```

### 500 Internal Server Error

External API returned an error or execution failed:

```json
{
  "statusCode": 500,
  "message": "HTTP 422: Unprocessable Entity",
  "error": "Internal Server Error"
}
```

## Usage Examples

### Basic GET Request

Execute a simple GET action that fetches user data:

```bash
curl -X POST https://api.tolstoy.com/actions/get-user-profile/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -H "Content-Type: application/json" \
  -d '{
    "inputs": {
      "user_id": "user_67890"
    }
  }'
```

### POST with Complex Data

Execute a POST action to create a GitHub issue:

```bash
curl -X POST https://api.tolstoy.com/actions/create-github-issue/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -H "Content-Type: application/json" \
  -d '{
    "inputs": {
      "title": "Bug in user authentication",
      "body": "Users are experiencing login issues after the latest deployment.",
      "labels": ["bug", "urgent"],
      "assignees": ["developer1", "developer2"]
    }
  }'
```

### User-Scoped OAuth Action

Execute an action using user-specific OAuth tokens:

```bash
curl -X POST https://api.tolstoy.com/actions/send-email/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -H "X-User-ID: user_67890" \
  -H "Content-Type: application/json" \
  -d '{
    "inputs": {
      "to": "customer@example.com",
      "subject": "Welcome to our service",
      "body": "Thank you for signing up!"
    }
  }'
```

### Template Variables in URLs

Actions can use template variables in their endpoint URLs:

```json
{
  "name": "Get Repository Info",
  "key": "get-repo-info",
  "method": "GET",
  "endpoint": "/repos/{{owner}}/{{repo}}",
  "inputSchema": [
    {"name": "owner", "type": "string", "required": true},
    {"name": "repo", "type": "string", "required": true}
  ]
}
```

Execute with template variables:

```bash
curl -X POST https://api.tolstoy.com/actions/get-repo-info/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -H "Content-Type: application/json" \
  -d '{
    "inputs": {
      "owner": "octocat",
      "repo": "Hello-World"
    }
  }'
```

This will make a request to `/repos/octocat/Hello-World`.

## Input Schema Validation

All inputs are validated against the action's `inputSchema` before execution:

### Schema Definition Example

```json
{
  "inputSchema": [
    {
      "name": "email",
      "type": "string",
      "required": true,
      "description": "Recipient email address",
      "validation": {
        "pattern": "^[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}$"
      }
    },
    {
      "name": "priority",
      "type": "string",
      "required": false,
      "description": "Message priority level",
      "validation": {
        "enum": ["low", "normal", "high", "urgent"]
      },
      "default": "normal"
    },
    {
      "name": "send_at",
      "type": "string",
      "required": false,
      "description": "Schedule send time (ISO 8601)",
      "validation": {
        "format": "date-time"
      }
    }
  ]
}
```

### Validation Errors

Invalid inputs will return a 400 error with details:

```json
{
  "statusCode": 400,
  "message": "Input validation failed: email is required, priority must be one of [low, normal, high, urgent]",
  "error": "Bad Request"
}
```

## Authentication Integration

The execute endpoint integrates with Tolstoy's authentication system to automatically inject the correct credentials.

### API Key Authentication

For tools configured with API key authentication:

```json
{
  "type": "apiKey",
  "config": {
    "headerName": "X-API-Key",
    "headerValue": "sk_live_1234567890abcdef"
  }
}
```

The system will automatically add the configured header to all requests.

### OAuth2 Authentication

For tools with OAuth2 configuration, user-specific tokens are used:

1. Organization admin configures OAuth2 client credentials
2. Users complete OAuth flow via `auth/login` endpoint
3. Execute endpoint uses stored user tokens
4. Tokens are automatically refreshed when needed

## Monitoring and Metrics

Action executions are tracked with Prometheus metrics:

### Metrics Exported

- `action_execution_total` - Counter of total executions by org, tool, action, and status
- `action_execution_seconds` - Histogram of execution duration

### Metric Labels

```
action_execution_total{orgId="org_12345", toolKey="Slack", actionKey="send-message", status="success"} 42
action_execution_seconds_bucket{orgId="org_12345", toolKey="Slack", actionKey="send-message", le="1.0"} 38
```

## Best Practices

### 1. Input Validation

Always define comprehensive input schemas:

```json
{
  "inputSchema": [
    {
      "name": "amount",
      "type": "number",
      "required": true,
      "validation": {
        "minimum": 0,
        "maximum": 1000000
      }
    }
  ]
}
```

### 2. Error Handling

Handle API errors gracefully in your client code:

```javascript
try {
  const response = await fetch('/actions/send-notification/execute', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${apiKey}`,
      'X-Org-ID': orgId,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      inputs: { message: 'Hello World' }
    })
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(`Action failed: ${error.message}`);
  }

  const result = await response.json();
  console.log('Action executed:', result.executionId);
} catch (error) {
  console.error('Execution failed:', error.message);
}
```

### 3. Testing Actions

Use the execute endpoint to test actions during development:

```bash
# Test with minimal inputs
curl -X POST https://api.tolstoy.com/actions/my-action/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -d '{"inputs": {}}' | jq

# Test with full inputs
curl -X POST https://api.tolstoy.com/actions/my-action/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -d '{
    "inputs": {
      "field1": "value1",
      "field2": "value2"
    }
  }' | jq
```

## Rate Limits

Action execution is subject to rate limiting:

- **Per Organization:** 1000 requests per minute
- **Per Action:** 100 requests per minute
- **Per User:** 500 requests per minute (for user-scoped actions)

Rate limit headers are included in responses:

```
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Reset: 1704123456
```

## Security Considerations

### Credential Management

- API keys are stored securely and never exposed in responses
- OAuth tokens are encrypted at rest and automatically rotated
- User credentials are scoped to prevent cross-user access

### Input Sanitization

- All inputs are validated and sanitized before use
- Template variable injection is safe - only input values are substituted
- SQL injection and XSS attacks are prevented through proper validation

### Audit Logging

All action executions are logged for security and compliance:

- Execution timestamp and duration
- User and organization identifiers  
- Input parameters (excluding sensitive data)
- Response status and error messages
- IP address and user agent

## Troubleshooting

### Common Issues

**Action Not Found (404)**
- Verify the action key is correct
- Check that the action exists in your organization
- Ensure the action hasn't been deleted

**Authentication Errors (401)**
- Verify your API key is valid and active
- Check that the organization ID is correct
- For OAuth actions, ensure the user has completed the auth flow

**Input Validation Errors (400)**
- Check the action's input schema requirements
- Verify all required fields are provided
- Ensure data types match the schema

**External API Errors (500)**
- Check the target API's status and availability
- Verify the configured endpoint URL is correct
- Review authentication credentials for the tool

### Debug Information

Add debug logging to troubleshoot issues:

```bash
curl -X POST https://api.tolstoy.com/actions/my-action/execute \
  -H "Authorization: Bearer sk_test_..." \
  -H "X-Org-ID: org_12345" \
  -H "X-Debug: true" \
  -d '{"inputs": {...}}'
```

This will include additional debug information in the response to help identify issues.

## Related Endpoints

- [Create Action](/api/actions#create-action) - Define new actions
- [List Actions](/api/actions#list-actions) - View available actions  
- [Tool Authentication](/auth/tool-auth) - Configure tool credentials
- [User Authentication](/auth/user-auth) - Set up OAuth flows