---
title: Core Features
sidebar_position: 4
---

# Core Features

Explore the main capabilities of the Tolstoy SDK for workflow automation.

## Workflow Execution

Execute workflows with full control over inputs and execution modes.

### Basic Workflow Execution

```typescript
// Execute workflow asynchronously (recommended)
const execution = await client.runFlow('flow_123', {
  userId: 'user_456',
  email: 'user@example.com',
  customField: 'any value'
});

console.log(`Execution started: ${execution.data.executionId}`);
```

### Synchronous vs Asynchronous Execution

```typescript
// Async execution (default, recommended for long-running workflows)
const asyncExecution = await client.runFlow('flow_123', inputs, true);

// Sync execution (for simple, fast workflows)
const syncExecution = await client.runFlow('flow_123', inputs, false);
```

### Monitor Execution Progress

```typescript
const execution = await client.runFlow('flow_123', inputs);

// Poll for completion
const checkStatus = async () => {
  const status = await client.getFlowExecution(
    'flow_123', 
    execution.data.executionId
  );
  
  console.log(`Status: ${status.data.status}`);
  
  if (status.data.status === 'running') {
    setTimeout(checkStatus, 2000); // Check again in 2 seconds
  } else {
    console.log('Workflow completed!', status.data);
  }
};

checkStatus();
```

### Complex Workflow Variables

```typescript
const execution = await client.runFlow('user_onboarding', {
  user: {
    email: 'user@example.com',
    name: 'John Doe',
    preferences: {
      notifications: true,
      theme: 'dark'
    }
  },
  metadata: {
    source: 'web_signup',
    timestamp: new Date().toISOString(),
    version: '2.0'
  },
  settings: {
    sendWelcomeEmail: true,
    createTrialAccount: true
  }
});
```

## Flow Management

List, search, and manage your workflow definitions.

### List All Flows

```typescript
const flows = await client.listFlows();

flows.data.forEach(flow => {
  console.log(`${flow.id}: ${flow.name}`);
  console.log(`  Description: ${flow.description}`);
  console.log(`  Status: ${flow.active ? 'Active' : 'Inactive'}`);
  console.log(`  Created: ${flow.createdAt}`);
});
```

### Advanced Flow Operations

```typescript
// Get detailed flow information
const flowDetails = await client.raw.flows.flowsControllerFindOne('flow_123');

// Get flow execution history
const executions = await client.raw.flows.flowsControllerGetFlowExecutions('flow_123');

// Get flow metrics
const metrics = await client.raw.flows.flowsControllerGetMetrics('flow_123');
console.log(`Success rate: ${metrics.data.successRate}%`);
console.log(`Average duration: ${metrics.data.avgDurationMs}ms`);
```

## Tool Integrations

Create and manage external API integrations.

### Create Tool Integration

```typescript
const tool = await client.createTool({
  name: 'GitHub API',
  baseUrl: 'https://api.github.com',
  authType: 'bearer',
  description: 'GitHub REST API integration',
  headers: {
    'Accept': 'application/vnd.github.v3+json',
    'User-Agent': 'Tolstoy-Integration'
  }
});

console.log(`Tool created: ${tool.data.id}`);
```

### Advanced Tool Configuration

```typescript
// Create tool with OAuth configuration
const oauthTool = await client.createTool({
  name: 'Google Sheets API',
  baseUrl: 'https://sheets.googleapis.com/v4',
  authType: 'oauth2',
  description: 'Google Sheets integration',
  oauthConfig: {
    authUrl: 'https://accounts.google.com/o/oauth2/auth',
    tokenUrl: 'https://oauth2.googleapis.com/token',
    scopes: ['https://www.googleapis.com/auth/spreadsheets']
  }
});

// Create tool with API key authentication
const apiKeyTool = await client.createTool({
  name: 'SendGrid API',
  baseUrl: 'https://api.sendgrid.com/v3',
  authType: 'apikey',
  description: 'Email service integration',
  headers: {
    'Content-Type': 'application/json'
  }
});
```

### List and Manage Tools

```typescript
const tools = await client.listTools();

tools.data.forEach(tool => {
  console.log(`${tool.name} (${tool.authType}): ${tool.baseUrl}`);
});

// Test tool connection
const testResult = await client.raw.tools.toolsControllerTest('tool_123');
console.log(`Connection test: ${testResult.data.success ? 'OK' : 'Failed'}`);
```

## Webhook Management

Set up event-driven integrations and notifications.

### Create Webhook

```typescript
const webhook = await client.createWebhook({
  name: 'Flow Completion Webhook',
  url: 'https://your-app.com/webhooks/tolstoy',
  events: ['flow.completed', 'flow.failed', 'flow.started'],
  active: true,
  secret: 'webhook_secret_key', // For signature verification
  metadata: {
    environment: 'production',
    version: 'v1'
  }
});
```

### Event Types

```typescript
// Available webhook events
const eventTypes = [
  'flow.started',     // Workflow execution began
  'flow.completed',   // Workflow finished successfully  
  'flow.failed',      // Workflow failed with error
  'flow.cancelled',   // Workflow was cancelled
  'tool.connected',   // Tool integration established
  'tool.failed',      // Tool integration failed
  'user.created',     // New user added to organization
  'org.updated'       // Organization settings changed
];

const webhook = await client.createWebhook({
  name: 'Complete Event Monitor',
  url: 'https://your-app.com/webhooks/all-events',
  events: eventTypes,
  active: true
});
```

### Webhook Security

```typescript
// Webhook with signature verification
const secureWebhook = await client.createWebhook({
  name: 'Secure Webhook',
  url: 'https://your-app.com/webhooks/secure',
  events: ['flow.completed'],
  active: true,
  secret: process.env.WEBHOOK_SECRET,
  verifySSL: true,
  timeout: 30000 // 30 second timeout
});

// Test webhook delivery
const testDelivery = await client.raw.webhooks.webhooksControllerTest('webhook_123');
console.log(`Test delivery: ${testDelivery.data.success ? 'OK' : 'Failed'}`);
```

### Manage Webhooks

```typescript
// List all webhooks
const webhooks = await client.listWebhooks();

webhooks.data.forEach(webhook => {
  console.log(`${webhook.name}: ${webhook.url}`);
  console.log(`  Events: ${webhook.events.join(', ')}`);
  console.log(`  Active: ${webhook.active}`);
  console.log(`  Last delivery: ${webhook.lastDelivery || 'Never'}`);
});

// Toggle webhook active state
await client.raw.webhooks.webhooksControllerToggle('webhook_123');

// Get webhook delivery logs
const deliveries = await client.raw.webhooks.webhooksControllerGetDeliveries('webhook_123');
```

## Advanced Features

### Batch Operations

```typescript
// Execute multiple workflows
const batchExecutions = await Promise.all([
  client.runFlow('onboarding_flow', { userId: 'user_1' }),
  client.runFlow('onboarding_flow', { userId: 'user_2' }),
  client.runFlow('onboarding_flow', { userId: 'user_3' })
]);

console.log(`Started ${batchExecutions.length} executions`);
```

### Error Handling with Retries

```typescript
async function executeWithRetry(flowId: string, inputs: any, maxRetries = 3) {
  for (let attempt = 1; attempt <= maxRetries; attempt++) {
    try {
      return await client.runFlow(flowId, inputs);
    } catch (error) {
      console.log(`Attempt ${attempt} failed:`, error.message);
      
      if (attempt === maxRetries) {
        throw error; // Final attempt failed
      }
      
      // Wait before retrying (exponential backoff)
      await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
    }
  }
}
```

### Custom Request Configuration

```typescript
// Access raw API for custom configurations
const customExecution = await client.raw.flows.flowsControllerExecuteFlow(
  'flow_123',
  { variables: inputs, useDurable: true },
  {
    timeout: 60000, // 60 second timeout
    headers: {
      'X-Request-ID': generateRequestId(),
      'X-Priority': 'high'
    }
  }
);
```

## Performance Optimization

### Connection Reuse

```typescript
// Create one client instance and reuse it
class WorkflowService {
  private client: TolstoyClient;

  constructor() {
    this.client = new TolstoyClient(
      process.env.TOLSTOY_API_URL!,
      process.env.TOLSTOY_ORG_ID!,
      getCurrentUserId()
    );
  }

  async executeWorkflow(flowId: string, inputs: any) {
    return this.client.runFlow(flowId, inputs);
  }
}
```

### Parallel Execution

```typescript
// Execute multiple operations in parallel
const [flows, tools, webhooks] = await Promise.all([
  client.listFlows(),
  client.listTools(), 
  client.listWebhooks()
]);

console.log('Loaded all data in parallel!');
```

## Next Steps

- [Examples](/sdk/examples) - Real-world implementation patterns
- [API Reference](/sdk/api-reference) - Complete method documentation
- [Advanced Usage](/sdk/advanced-usage) - Expert patterns and optimization